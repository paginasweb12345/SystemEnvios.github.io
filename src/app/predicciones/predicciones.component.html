<div class="contenedor" *ngIf="!cargando; else loading">
  
  <h2 class="titulo">ğŸ“Š Panel de AnalÃ­tica Inteligente y Predicciones</h2>
  <p class="subtitulo">Resumen avanzado del rendimiento de los envÃ­os, tendencias y proyecciones.</p>

  <!-- === TARJETAS PRINCIPALES === -->
  <div class="grid">
    <div class="card highlight">
      <h3>Total de EnvÃ­os</h3>
      <p class="numero">{{ stats.totalEnvios }}</p>
    </div>

    <div class="card highlight">
      <h3>Porcentaje de Cumplimiento</h3>
      <p class="numero verde">{{ stats.porcentajeCumplimiento }}%</p>
    </div>

    <div class="card">
      <h3>Promedio por DÃ­a</h3>
      <p class="numero">{{ promedioPorDia }}</p>
    </div>

    <div class="card">
      <h3>PredicciÃ³n para MaÃ±ana</h3>
      <p class="numero azul">{{ prediccionManana }}</p>
    </div>
  </div>

  <!-- === DETALLES AVANZADOS === -->
  <h3 class="seccion-titulo">ğŸ” AnÃ¡lisis Detallado</h3>

  <div class="grid-doble">
    
    <div class="card">
      <h3>DÃ­a con Mayor Demanda</h3>
      <p class="numero grande" *ngIf="diaPico">
        ğŸ“… {{ diaPico.fecha }}  
        <br>
        <span class="resaltado">{{ diaPico.cantidad }} envÃ­os</span>
      </p>
      <p *ngIf="!diaPico">Sin datos</p>
    </div>

    <div class="card">
      <h3>Tiempo Promedio de Entrega</h3>
      <p class="numero grande">{{ tiempoPromedioEntrega }} dÃ­as</p>
    </div>

    <div class="card">
      <h3>Porcentaje de Devoluciones</h3>
      <p class="numero rojo grande">{{ porcentajeDevoluciones }}%</p>
    </div>

    <div class="card">
      <h3>EnvÃ­os por Estado</h3>
      <ul class="estado-lista">
        <li>ğŸ“¦ Entregados: <span>{{ stats.entregados }}</span></li>
        <li>ğŸšš En trÃ¡nsito: <span>{{ stats.enTransito }}</span></li>
        <li>â³ Pendientes: <span>{{ stats.pendientes }}</span></li>
        <li>ğŸ” Devueltos: <span class="rojo">{{ stats.devueltos }}</span></li>
      </ul>
    </div>

  </div>

  <!-- === DESTINOS FRECUENTES === -->
  <h3 class="seccion-titulo">ğŸ“ Destinos MÃ¡s Frecuentes</h3>

  <div class="card full">
    <p *ngIf="destinosFrecuentes.length === 0">Sin datos</p>

    <ul *ngIf="destinosFrecuentes.length > 0" class="lista-frecuentes">
      <li *ngFor="let d of destinosFrecuentes">
        <span class="destino">{{ d.destino }}</span>
        <span class="badge">{{ d.cantidad }} envÃ­os</span>
      </li>
    </ul>
  </div>

  <!-- === CLASIFICACIÃ“N DE COSTOS === -->
  <h3 class="seccion-titulo">ğŸ’° ClasificaciÃ³n de Costos</h3>

  <div class="card full">
    <ul class="costo-lista">
      <li *ngFor="let c of costosClasificados">
        <span>{{ c.rango }}</span>
        <span class="badge secundario">{{ c.cantidad }}</span>
      </li>
    </ul>
  </div>

</div>

<!-- === LOADING SCREEN === -->
<ng-template #loading>
  <div class="loading">
    <div class="spinner"></div>
    <p>Cargando anÃ¡lisis avanzado...</p>
  </div>
</ng-template>
