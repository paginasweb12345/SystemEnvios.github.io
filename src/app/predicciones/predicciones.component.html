<div class="contenedor" *ngIf="!cargando; else loading">
  
  <h2 class="titulo">Panel de Analítica Inteligente y Predicciones</h2>
  <p class="subtitulo">Resumen del rendimiento de los envíos y proyecciones.</p>

  <div class="grid">
    <div class="card highlight">
      <h3>Total de Envíos</h3>
      <p class="numero">{{ stats.totalEnvios }}</p>
    </div>

    <div class="card highlight">
      <h3>Porcentaje de Cumplimiento</h3>
      <p class="numero verde">{{ stats.porcentajeCumplimiento }}%</p>
    </div>

    <div class="card">
      <h3>Promedio por Día</h3>
      <p class="numero">{{ promedioPorDia }}</p>
    </div>

    <div class="card">
      <h3>Predicción para Mañana</h3>
      <p class="numero azul">{{ prediccionManana }}</p>
    </div>
  </div>

  <h3 class="seccion-titulo">Análisis Detallado</h3>

  <div class="grid-doble">
    
    <div class="card">
      <h3>Día con Mayor Demanda</h3>
      <p class="numero grande" *ngIf="diaPico">
        {{ diaPico.fecha }}  
        <br>
        <span class="resaltado">{{ diaPico.cantidad }} envíos</span>
      </p>
      <p *ngIf="!diaPico">Sin datos</p>
    </div>

    <div class="card">
      <h3>Tiempo Promedio de Entrega</h3>
      <p class="numero grande">{{ tiempoPromedioEntrega }} días</p>
    </div>

    <div class="card">
      <h3>Porcentaje de Devoluciones</h3>
      <p class="numero rojo grande">{{ porcentajeDevoluciones }}%</p>
    </div>

    <div class="card">
      <h3>Envíos por Estado</h3>
      <ul class="estado-lista">
        <li>Entregados: <span>{{ stats.entregados }}</span></li>
        <li>En tránsito: <span>{{ stats.enTransito }}</span></li>
        <li>Pendientes: <span>{{ stats.pendientes }}</span></li>
        <li>Devueltos: <span class="rojo">{{ stats.devueltos }}</span></li>
      </ul>
    </div>

  </div>

  <h3 class="seccion-titulo">Destinos Más Frecuentes</h3>

  <div class="card full">
    <p *ngIf="destinosFrecuentes.length === 0">Sin datos</p>

    <ul *ngIf="destinosFrecuentes.length > 0" class="lista-frecuentes">
      <li *ngFor="let d of destinosFrecuentes">
        <span class="destino">{{ d.destino }}</span>
        <span class="badge">{{ d.cantidad }} envíos</span>
      </li>
    </ul>
  </div>

  <h3 class="seccion-titulo">Clasificación de Costos</h3>

  <div class="card full">
    <ul class="costo-lista">
      <li *ngFor="let c of costosClasificados">
        <span>{{ c.rango }}</span>
        <span class="badge secundario">{{ c.cantidad }}</span>
      </li>
    </ul>
  </div>

</div>

<ng-template #loading>
  <div class="loading">
    <div class="spinner"></div>
    <p>Cargando análisis...</p>
  </div>
</ng-template>
